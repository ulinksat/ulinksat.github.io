<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=34837&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.139.4">
    <meta name="generator" content="Relearn 7.3.1">
    <meta name="description" content="QSPI flash partition Ë¶èÂäÉ ÁõÆÂâç ULinkSat SDR ÁöÑ QSPI flash partition Ë¶èÂäÉÂ¶Ç‰∏ã
partition name image name partition offset partition size partition size boot BOOT.BIN 0x0 0x600000 6MiB bootenv ‚Äì 0x600000 0x20000 128KiB bootscr boot.scr 0x620000 0x20000 128KiB kernel image.ub 0x640000 0x600000 6MiB rootfs rootfs.jffs2 0xC40000 0xC800000 200MiB QSPI flash erase size Á¢∫Ë™ç erase block Êü• datasheet
‰æãÂ¶Ç ULinkSat SDR ‰ΩøÁî® Micron MT25QL02GCÔºåÊü•Ë©¢ datasheet ÁµêÊûú">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Change RootFS to JFFS2 :: ULinkSat">
    <meta name="twitter:description" content="QSPI flash partition Ë¶èÂäÉ ÁõÆÂâç ULinkSat SDR ÁöÑ QSPI flash partition Ë¶èÂäÉÂ¶Ç‰∏ã
partition name image name partition offset partition size partition size boot BOOT.BIN 0x0 0x600000 6MiB bootenv ‚Äì 0x600000 0x20000 128KiB bootscr boot.scr 0x620000 0x20000 128KiB kernel image.ub 0x640000 0x600000 6MiB rootfs rootfs.jffs2 0xC40000 0xC800000 200MiB QSPI flash erase size Á¢∫Ë™ç erase block Êü• datasheet
‰æãÂ¶Ç ULinkSat SDR ‰ΩøÁî® Micron MT25QL02GCÔºåÊü•Ë©¢ datasheet ÁµêÊûú">
    <meta property="og:url" content="http://localhost:34837/petalinux/change-rootfs-jffs2/index.html">
    <meta property="og:site_name" content="ULinkSat">
    <meta property="og:title" content="Change RootFS to JFFS2 :: ULinkSat">
    <meta property="og:description" content="QSPI flash partition Ë¶èÂäÉ ÁõÆÂâç ULinkSat SDR ÁöÑ QSPI flash partition Ë¶èÂäÉÂ¶Ç‰∏ã
partition name image name partition offset partition size partition size boot BOOT.BIN 0x0 0x600000 6MiB bootenv ‚Äì 0x600000 0x20000 128KiB bootscr boot.scr 0x620000 0x20000 128KiB kernel image.ub 0x640000 0x600000 6MiB rootfs rootfs.jffs2 0xC40000 0xC800000 200MiB QSPI flash erase size Á¢∫Ë™ç erase block Êü• datasheet
‰æãÂ¶Ç ULinkSat SDR ‰ΩøÁî® Micron MT25QL02GCÔºåÊü•Ë©¢ datasheet ÁµêÊûú">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Petalinux">
    <meta property="article:published_time" content="2025-01-25T16:42:10+08:00">
    <meta property="article:modified_time" content="2025-01-25T16:42:10+08:00">
    <meta itemprop="name" content="Change RootFS to JFFS2 :: ULinkSat">
    <meta itemprop="description" content="QSPI flash partition Ë¶èÂäÉ ÁõÆÂâç ULinkSat SDR ÁöÑ QSPI flash partition Ë¶èÂäÉÂ¶Ç‰∏ã
partition name image name partition offset partition size partition size boot BOOT.BIN 0x0 0x600000 6MiB bootenv ‚Äì 0x600000 0x20000 128KiB bootscr boot.scr 0x620000 0x20000 128KiB kernel image.ub 0x640000 0x600000 6MiB rootfs rootfs.jffs2 0xC40000 0xC800000 200MiB QSPI flash erase size Á¢∫Ë™ç erase block Êü• datasheet
‰æãÂ¶Ç ULinkSat SDR ‰ΩøÁî® Micron MT25QL02GCÔºåÊü•Ë©¢ datasheet ÁµêÊûú">
    <meta itemprop="datePublished" content="2025-01-25T16:42:10+08:00">
    <meta itemprop="dateModified" content="2025-01-25T16:42:10+08:00">
    <meta itemprop="wordCount" content="583">
    <title>Change RootFS to JFFS2 :: ULinkSat</title>
    <link href="../../css/fontawesome-all.min.css?1737904984" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../css/fontawesome-all.min.css?1737904984" rel="stylesheet"></noscript>
    <link href="../../css/auto-complete.css?1737904984" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../css/auto-complete.css?1737904984" rel="stylesheet"></noscript>
    <link href="../../css/perfect-scrollbar.min.css?1737904984" rel="stylesheet">
    <link href="../../css/theme.css?1737904984" rel="stylesheet">
    <link href="../../css/format-html.css?1737904984" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:34837';
      window.relearn.min = ``;
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      // variant stuff
      window.relearn.themevariants = [ 'auto' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.localStorage.setItem(window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.localStorage.getItem(window.relearn.absBaseUri + "/variant");
        var select = document.querySelector("#R-select-variant");
        if (select) {
          select.value = variant;
        }
      }
      window.relearn.initVariant = function() {
        var variant = window.localStorage.getItem(window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.localStorage.setItem(window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
  </head>
  <body class="mobile-support html" data-url="../../petalinux/change-rootfs-jffs2/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#qspi-flash-partition-Ë¶èÂäÉ">QSPI flash partition Ë¶èÂäÉ</a></li>
    <li><a href="#qspi-flash-erase-size">QSPI flash erase size</a>
      <ul>
        <li><a href="#Á¢∫Ë™ç-erase-block">Á¢∫Ë™ç erase block</a></li>
        <li><a href="#petalinux-ËÆäÊõ¥-erase-size">PetaLinux ËÆäÊõ¥ erase size</a></li>
      </ul>
    </li>
    <li><a href="#build-os-image">Build OS image</a></li>
    <li><a href="#ÁáíÈåÑ-qspi-flash">ÁáíÈåÑ QSPI flash</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../petalinux/index.html"><span itemprop="name">Petalinux</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Change RootFS to JFFS2</span><meta itemprop="position" content="2"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="../../petalinux/build-petalinux-os-image/index.html" title="Build PetaLinux OS Image (ü°ê)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="../../petalinux/flash-os-image/index.html" title="Flash OS image (ü°í)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable petalinux" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="change-rootfs-to-jffs2">Change RootFS to JFFS2</h1>

<h2 id="qspi-flash-partition-Ë¶èÂäÉ">QSPI flash partition Ë¶èÂäÉ</h2>
<p>ÁõÆÂâç ULinkSat SDR ÁöÑ QSPI flash partition Ë¶èÂäÉÂ¶Ç‰∏ã</p>
<table>
  <thead>
      <tr>
          <th>partition name</th>
          <th>image name</th>
          <th>partition offset</th>
          <th>partition size</th>
          <th>partition size</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>boot</td>
          <td>BOOT.BIN</td>
          <td>0x0</td>
          <td>0x600000</td>
          <td>6MiB</td>
      </tr>
      <tr>
          <td>bootenv</td>
          <td>&ndash;</td>
          <td>0x600000</td>
          <td>0x20000</td>
          <td>128KiB</td>
      </tr>
      <tr>
          <td>bootscr</td>
          <td>boot.scr</td>
          <td>0x620000</td>
          <td>0x20000</td>
          <td>128KiB</td>
      </tr>
      <tr>
          <td>kernel</td>
          <td>image.ub</td>
          <td>0x640000</td>
          <td>0x600000</td>
          <td>6MiB</td>
      </tr>
      <tr>
          <td>rootfs</td>
          <td>rootfs.jffs2</td>
          <td>0xC40000</td>
          <td>0xC800000</td>
          <td>200MiB</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="qspi-flash-erase-size">QSPI flash erase size</h2>
<h3 id="Á¢∫Ë™ç-erase-block">Á¢∫Ë™ç erase block</h3>
<ul>
<li>
<p>Êü• datasheet</p>
<p>‰æãÂ¶Ç ULinkSat SDR ‰ΩøÁî® Micron MT25QL02GCÔºåÊü•Ë©¢ datasheet ÁµêÊûú</p>
<p><a href="#R-image-88a4f33b646a238f42a9eaf34db3b574" class="lightbox-link"><img alt="image-20250125174850066" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="../../petalinux/change-rootfs-jffs2/image-20250125174850066.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-88a4f33b646a238f42a9eaf34db3b574"><img alt="image-20250125174850066" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="../../petalinux/change-rootfs-jffs2/image-20250125174850066.png"></a></p>
<p>Êúâ 64KB„ÄÅ32KB Âíå 4KB</p>
</li>
<li>
<p>u-boot ÂÅµÊ∏¨</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Zynq&gt; sf probe <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>SF: Detected mt25ql02g with page size <span style="color:#ae81ff">256</span> Bytes, erase size <span style="color:#ae81ff">4</span> KiB, total <span style="color:#ae81ff">256</span> MiB</span></span></code></pre></div>
<p>È°ØÁ§∫Áà≤ 4KB</p>
<blockquote>
<p>Ê≠£Á¢∫ÁöÑ erase size È†àÂØ¶ÈöõÁáíÈåÑÂæåÊâçËÉΩÁ¢∫Ë™ç
‰æãÂ¶Ç ULinkSat SDR ‰ΩøÁî® Micron MT25QL02GC ÂØ¶ÈöõÁáíÈåÑÂæåÁ¢∫Ë™çÈ†àÁà≤ 4KBÔºåÂê¶Ââá rootfs ÊúÉÁáíÈåÑ‰∏çÂÆåÂÖ®ÔºåÂ∞éËá¥Á≥ªÁµ±ÈÅã‰ΩúÁï∞Â∏∏</p>
</blockquote>
</li>
</ul>
<h3 id="petalinux-ËÆäÊõ¥-erase-size">PetaLinux ËÆäÊõ¥ erase size</h3>
<ul>
<li>
<p>PetaLinux system config ÈÅ∏Êìá erase block ÁÇ∫ 4KiB</p>
<p><a href="#R-image-fae74968093123ec7ee4e6c88a41bf48" class="lightbox-link"><img alt="image-20250126231606738" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="../../petalinux/change-rootfs-jffs2/image-20250126231606738.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-fae74968093123ec7ee4e6c88a41bf48"><img alt="image-20250126231606738" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="../../petalinux/change-rootfs-jffs2/image-20250126231606738.png"></a></p>
<p><a href="#R-image-e8ed727ff53fe0483226c49ddb9f7251" class="lightbox-link"><img alt="image-20250126231626658" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="../../petalinux/change-rootfs-jffs2/image-20250126231626658.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-e8ed727ff53fe0483226c49ddb9f7251"><img alt="image-20250126231626658" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="../../petalinux/change-rootfs-jffs2/image-20250126231626658.png"></a></p>
<p><a href="#R-image-5b7bb28715584abd65e2fa0164ab5c68" class="lightbox-link"><img alt="image-20250126231647490" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="../../petalinux/change-rootfs-jffs2/image-20250126231647490.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-5b7bb28715584abd65e2fa0164ab5c68"><img alt="image-20250126231647490" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="../../petalinux/change-rootfs-jffs2/image-20250126231647490.png"></a></p>
</li>
</ul>
<blockquote>
<ul>
<li>
<p>Ë®≠ÁΩÆ JFFS2 rootfs ÁöÑÊñπÂºèÂèØÂèÉËÄÉ PetaLinux Tools Documentation: Reference Guide (UG1144) <a href="https://docs.amd.com/r/2022.1-English/ug1144-petalinux-tools-reference-guide/Configuring-JFFS2-Boot" rel="external" target="_blank">Configuring JFFS2 Boot</a>Ôºå‰ΩÜË¶ÅÊ≥®ÊÑèÂùë‰∏çÂ∞ë</p>
</li>
<li>
<p>Ëã•ÂÉÖÂàáÊèõ ULinkSat SDR Áà≤ JFFS2 bootÔºåÂèØÂèÉËÄÉ‰ª•‰∏ã shell script</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>msg_info<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	echo -e <span style="color:#e6db74">&#34;\e[0;32m</span><span style="color:#e6db74">${</span>1<span style="color:#e6db74">}</span><span style="color:#e6db74">\e[0m&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msg_error<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	echo -e <span style="color:#e6db74">&#34;[ERROR] \e[0;31m</span><span style="color:#e6db74">${</span>1<span style="color:#e6db74">}</span><span style="color:#e6db74">\e[0m&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>error_exit<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	msg_error <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>1<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	false
</span></span><span style="display:flex;"><span>	exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>disable_all_rootfs<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	msg_info <span style="color:#e6db74">&#34;----&gt;&gt;&gt; Disable all rootfs types&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> f in <span style="color:#e6db74">${</span>FS_LST<span style="color:#e6db74">}</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>		f<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;CONFIG_SUBSYSTEM_ROOTFS_</span><span style="color:#e6db74">${</span>f<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">[[</span> <span style="color:#e6db74">${</span>TEST<span style="color:#e6db74">}</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]]</span> <span style="color:#f92672">||</span> echo <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>f<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>		sed <span style="color:#e6db74">${</span>SED_OPTS<span style="color:#e6db74">}</span> <span style="color:#e6db74">&#34;s/.*</span><span style="color:#e6db74">${</span>f<span style="color:#e6db74">}</span><span style="color:#e6db74">.*/# </span><span style="color:#e6db74">${</span>f<span style="color:#e6db74">}</span><span style="color:#e6db74"> is not set/g&#34;</span> <span style="color:#e6db74">${</span>SYSCONF<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>disable_all_jffs2_erase_size<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	local size_lst<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;4 8 16 32 64 128 256 512&#34;</span>
</span></span><span style="display:flex;"><span>	msg_info <span style="color:#e6db74">&#34;----&gt;&gt;&gt; Disable all JFFS2 erase sizes&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> s in <span style="color:#e6db74">${</span>size_lst<span style="color:#e6db74">}</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>		s<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;CONFIG_SUBSYSTEM_JFFS2_ERASE_SIZE_</span><span style="color:#e6db74">${</span>s<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">[[</span> <span style="color:#e6db74">${</span>TEST<span style="color:#e6db74">}</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]]</span> <span style="color:#f92672">||</span> echo <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>s<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#66d9ef">$(</span>grep <span style="color:#e6db74">${</span>s<span style="color:#e6db74">}</span> <span style="color:#f92672">&lt;&lt;&lt;</span> <span style="color:#e6db74">${</span>SYSCONF<span style="color:#e6db74">}</span><span style="color:#66d9ef">)</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>			sed <span style="color:#e6db74">${</span>SED_OPTS<span style="color:#e6db74">}</span> <span style="color:#e6db74">&#34;s/.*</span><span style="color:#e6db74">${</span>s<span style="color:#e6db74">}</span><span style="color:#e6db74">.*/# </span><span style="color:#e6db74">${</span>s<span style="color:#e6db74">}</span><span style="color:#e6db74"> is not set/g&#34;</span> <span style="color:#e6db74">${</span>SYSCONF<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>			echo <span style="color:#e6db74">&#34;# </span><span style="color:#e6db74">${</span>s<span style="color:#e6db74">}</span><span style="color:#e6db74"> is not set&#34;</span> &gt;&gt;  <span style="color:#e6db74">${</span>SYSCONF<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	unset size_lst
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>chg_rootfs<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">[[</span> -z <span style="color:#e6db74">${</span>FS_TYPE<span style="color:#e6db74">}</span> <span style="color:#f92672">]]</span> <span style="color:#f92672">&amp;&amp;</span> error_exit <span style="color:#e6db74">&#34;Rootfs type not assign.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	FS_TYPE<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>echo <span style="color:#e6db74">${</span>FS_TYPE<span style="color:#e6db74">}</span> | tr <span style="color:#e6db74">&#39;[:lower:]&#39;</span> <span style="color:#e6db74">&#39;[:upper:]&#39;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>	msg_info <span style="color:#e6db74">&#34;----&gt;&gt;&gt; Set rootfs to </span><span style="color:#e6db74">${</span>FS_TYPE<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	FS_LST<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;INITRAMFS INITRD JFFS2 UBIFS EXT4 OTHER&#34;</span>
</span></span><span style="display:flex;"><span>	FS_FOUND<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> f in <span style="color:#e6db74">${</span>FS_LST<span style="color:#e6db74">}</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">[[</span> <span style="color:#e6db74">${</span>f<span style="color:#e6db74">}</span> !<span style="color:#f92672">=</span> <span style="color:#e6db74">${</span>FS_TYPE<span style="color:#e6db74">}</span> <span style="color:#f92672">]]</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>		FS_FOUND<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>		break
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">[[</span> <span style="color:#e6db74">${</span>FS_FOUND<span style="color:#e6db74">}</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]]</span> <span style="color:#f92672">&amp;&amp;</span> error_exit <span style="color:#e6db74">&#34;Rootfs </span><span style="color:#e6db74">${</span>FS_TYPE<span style="color:#e6db74">}</span><span style="color:#e6db74"> not supported&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Disable all rootfs types</span>
</span></span><span style="display:flex;"><span>	disable_all_rootfs
</span></span><span style="display:flex;"><span>	msg_info <span style="color:#e6db74">&#34;----&gt;&gt;&gt; Enable rootfs </span><span style="color:#e6db74">${</span>FS_TYPE<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	ERASE_SIZE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;4&#34;</span>
</span></span><span style="display:flex;"><span>	f<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;CONFIG_SUBSYSTEM_ROOTFS_</span><span style="color:#e6db74">${</span>FS_TYPE<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>	sed <span style="color:#e6db74">${</span>SED_OPTS<span style="color:#e6db74">}</span> <span style="color:#e6db74">&#34;s/.*</span><span style="color:#e6db74">${</span>f<span style="color:#e6db74">}</span><span style="color:#e6db74">.*/</span><span style="color:#e6db74">${</span>f<span style="color:#e6db74">}</span><span style="color:#e6db74">=y/g&#34;</span> <span style="color:#e6db74">${</span>SYSCONF<span style="color:#e6db74">}</span> <span style="color:#f92672">&amp;&amp;</span> sync <span style="color:#f92672">||</span> error_exit <span style="color:#e6db74">&#34;Failed to change rootfs type&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#e6db74">${</span>FS_TYPE<span style="color:#e6db74">}</span> in
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#39;JFFS2&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>			disable_all_jffs2_erase_size
</span></span><span style="display:flex;"><span>			msg_info <span style="color:#e6db74">&#34;----&gt;&gt;&gt; Set JFFS2 erase size to </span><span style="color:#e6db74">${</span>ERASE_SIZE<span style="color:#e6db74">}</span><span style="color:#e6db74">K&#34;</span>
</span></span><span style="display:flex;"><span>			sed <span style="color:#e6db74">${</span>SED_OPTS<span style="color:#e6db74">}</span> <span style="color:#e6db74">&#34;s/.*CONFIG_SUBSYSTEM_JFFS2_ERASE_SIZE_</span><span style="color:#e6db74">${</span>ERASE_SIZE<span style="color:#e6db74">}</span><span style="color:#e6db74">.*/CONFIG_SUBSYSTEM_JFFS2_ERASE_SIZE_</span><span style="color:#e6db74">${</span>ERASE_SIZE<span style="color:#e6db74">}</span><span style="color:#e6db74">=y/g&#34;</span> <span style="color:#e6db74">${</span>SYSCONF<span style="color:#e6db74">}</span> <span style="color:#f92672">&amp;&amp;</span> sync <span style="color:#f92672">||</span> error_exit <span style="color:#e6db74">&#34;Failed to change JFFS erase size&#34;</span> 
</span></span><span style="display:flex;"><span>			;;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	msg_info <span style="color:#e6db74">&#34;----&gt;&gt;&gt; Update system config&#34;</span>
</span></span><span style="display:flex;"><span>	petalinux-config --silent <span style="color:#f92672">||</span> error_exit <span style="color:#e6db74">&#34;Failed to update system config&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print_usage<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	echo <span style="color:#e6db74">&#34;Usage: </span><span style="color:#66d9ef">$(</span>basename $0<span style="color:#66d9ef">)</span><span style="color:#e6db74"> [-r &lt;rootfs&gt;] [-t]&#34;</span>
</span></span><span style="display:flex;"><span>	exit <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cmdpath<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>dirname <span style="color:#66d9ef">$(</span>readlink -f $0<span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> getopts <span style="color:#e6db74">&#34;r:m:qth&#34;</span> arg
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> $arg in
</span></span><span style="display:flex;"><span>		r<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>			FS_TYPE<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>tr <span style="color:#e6db74">&#39;[:upper:]&#39;</span> <span style="color:#e6db74">&#39;[:lower:]&#39;</span> <span style="color:#f92672">&lt;&lt;&lt;</span> <span style="color:#e6db74">${</span>OPTARG<span style="color:#e6db74">}</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>			;;
</span></span><span style="display:flex;"><span>		t<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>			TEST<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>			;;
</span></span><span style="display:flex;"><span>		?|h<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>			print_usage
</span></span><span style="display:flex;"><span>			;;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>shift <span style="color:#66d9ef">$((</span>OPTIND <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>PROJDIR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[[</span> -z <span style="color:#e6db74">${</span>PROJDIR<span style="color:#e6db74">}</span> <span style="color:#f92672">]]</span> <span style="color:#f92672">&amp;&amp;</span> PROJDIR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[[</span> -d <span style="color:#e6db74">${</span>PROJDIR<span style="color:#e6db74">}</span> <span style="color:#f92672">]]</span> <span style="color:#f92672">||</span> error_exit <span style="color:#e6db74">&#34;Directory </span><span style="color:#e6db74">${</span>PROJDIR<span style="color:#e6db74">}</span><span style="color:#e6db74"> not found&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TEST<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>SED_OPTS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-e&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[[</span> <span style="color:#e6db74">${</span>TEST<span style="color:#e6db74">}</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]]</span> <span style="color:#f92672">&amp;&amp;</span> SED_OPTS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-i </span><span style="color:#e6db74">${</span>SED_OPTS<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SYSCONF<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PROJDIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/project-spec/configs/config&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[[</span> -z <span style="color:#e6db74">${</span>FS_TYPE<span style="color:#e6db74">}</span> <span style="color:#f92672">]]</span> <span style="color:#f92672">||</span> chg_rootfs</span></span></code></pre></div>
</li>
</ul>
</blockquote>
<hr>
<h2 id="build-os-image">Build OS image</h2>
<p>Ë¶ã <a href="https://hugopage-881916.gitlab.io/petalinux/build-petalinux-os-image" rel="external" target="_blank">Build PetaLinux OS Image</a></p>
<hr>
<h2 id="ÁáíÈåÑ-qspi-flash">ÁáíÈåÑ QSPI flash</h2>
<p>Ë¶ã Flash OS Image ÁöÑ <a href="http://localhost:1313/petalinux/flash-os-image/#%E7%87%92%E9%8C%84-jffs2" rel="external" target="_blank">ÁáíÈåÑ JFFS2</a></p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
          <a id="R-logo" class="R-default" href="../../index.html">
            ULinkSat
          </a>
        </div>
        <script>
          window.index_js_url="../../searchindex.en.js?1737904984";
        </script>
        <search><form action="../../search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="../../js/auto-complete.js?1737904984" defer></script>
        <script src="../../js/lunr/lunr.min.js?1737904984" defer></script>
        <script src="../../js/lunr/lunr.stemmer.support.min.js?1737904984" defer></script>
        <script src="../../js/lunr/lunr.multi.min.js?1737904984" defer></script>
        <script src="../../js/lunr/lunr.en.min.js?1737904984" defer></script>
        <script src="../../js/search.js?1737904984" defer></script>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <ul>
          <li><a class="padding" href="../../index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
        </ul>
        <hr class="padding">
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div id="R-shortcutmenu-home" class="R-sidebarmenu">
          <ul class="enlarge morespace collapsible-menu">
            <li class="parent " data-nav-id="/petalinux/index.html"><a class="padding" href="../../petalinux/index.html">Petalinux</a><ul id="R-subsections-2781be08bbf107164e99b4791835c73d" class="collapsible-menu">
            <li class="" data-nav-id="/petalinux/petalinux-in-docker/index.html"><a class="padding" href="../../petalinux/petalinux-in-docker/index.html">Install PetaLinux 2022.1 in Docker</a></li>
            <li class="" data-nav-id="/petalinux/create-sdr-project/index.html"><a class="padding" href="../../petalinux/create-sdr-project/index.html">Create SDR Project</a></li>
            <li class="" data-nav-id="/petalinux/build-petalinux-os-image/index.html"><a class="padding" href="../../petalinux/build-petalinux-os-image/index.html">Build PetaLinux OS Image</a></li>
            <li class="active " data-nav-id="/petalinux/change-rootfs-jffs2/index.html"><a class="padding" href="../../petalinux/change-rootfs-jffs2/index.html">Change RootFS to JFFS2</a></li>
            <li class="" data-nav-id="/petalinux/flash-os-image/index.html"><a class="padding" href="../../petalinux/flash-os-image/index.html">Flash OS image</a></li></ul></li>
          </ul>
        </div>
    
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div>
        <div id="R-menu-footer">
          <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter">
          <div id="R-prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks">
            <ul>
              <li id="R-select-language-container" class="footerLangSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-language"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-language">Language</label>
                    <select id="R-select-language" onchange="location = this.querySelector( this.value ).dataset.url;">
                      <option id="R-select-language-en" value="#R-select-language-en" data-url="../../petalinux/change-rootfs-jffs2/index.html" lang="en-us" selected></option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
              <li id="R-select-variant-container" class="footerVariantSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-paint-brush"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-variant">Theme</label>
                    <select id="R-select-variant" onchange="window.relearn.changeVariant( this.value );">
                      <option id="R-select-variant-auto" value="auto" selected>Auto</option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
                <script>window.relearn.markVariant();</script>
              </li>
              <li class="footerVisitedLinks">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-history"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <button onclick="clearHistory();">Clear History</button>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
            </ul>
          </div>
          <div id="R-footer" class="footerFooter showFooter">
        <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
          </div>
        </div>
      </div>
    </aside>
    <script src="../../js/clipboard.min.js?1737904984" defer></script>
    <script src="../../js/perfect-scrollbar.min.js?1737904984" defer></script>
    <script src="../../js/theme.js?1737904984" defer></script>
  </body>
</html>
